
pkgname=volume_key
pkgver=0.3.9
pkgrel=2
pkgdesc="Library for manipulating storage volume encryption keys and storing them separately from volumes"
arch=('x86_64')
url="https://pagure.io/volume_key"
license=('GPL')
depends=('cryptsetup' 'nss' 'util-linux' 'gpgme')
source=("https://releases.pagure.org/volume_key/${pkgname}-${pkgver}.tar.xz"
        'config_h.patch'
        "https://pagure.io/volume_key/c/ecef526a51c5a276681472fd6df239570c9ce518.patch")
md5sums=('a2d14931177c660e1f3ebbcf5f47d8e2'
         'a55a060f489ac5243d84e9bffd5c994f'
         '63e8f1731c423e1eb192a3dc5d1e2eb4')

build() {
    cd ${pkgname}-${pkgver}
    patch -p1 -i ${srcdir}/config_h.patch
    # needed with cryptsetup 2.0.0
    patch -p1 -i ${srcdir}/ecef526a51c5a276681472fd6df239570c9ce518.patch
    
    ./configure --prefix=/usr         
    make
}

package() {
    cd ${pkgname}-${pkgver}

    make DESTDIR=${pkgdir}/ install
}
 
