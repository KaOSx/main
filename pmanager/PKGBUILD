
pkgname=pmanager
pkgver=0.3.2
pkgrel=1
_commit=def5fa0eb85e8d3f3593544679540a7faed3b881
pkgdesc="Packages viewer & Mirrors status used by KaOS"
arch=('x86_64')
url="https://github.com/KaOSx/pmanager"
license=('Public Domain')
depends=('go' 'sqlite')
backup=('etc/pmanager/pmanager.conf')
source=("https://github.com/KaOSx/pmanager/archive/${_commit}.zip"
        'pmanager.service'
        'pmanager_update.service'
        'pmanager_update.timer')
md5sums=('83629b6614e34416c241f00a1387b49c'
         '680f391419f6ced62a6984f9a1eb69ef'
         '4d340e0496cc1c69fb0a319ba460d39b'
         '9ae0fe194f318cff49054bf6d57d4978')
 
build() {
  cd ${pkgname}-${_commit}

  go build -o pmanager pmanager.go
}

package() {
  cd ${pkgname}-${_commit} 

  install -Dm755 pmanager ${pkgdir}/usr/bin/pmanager

  install -Dm644 ../pmanager.service ${pkgdir}/usr/lib/systemd/system/pmanager.service
  install -Dm644 ../pmanager_update.service ${pkgdir}/usr/lib/systemd/system/pmanager_update.service
  install -Dm644 ../pmanager_update.timer ${pkgdir}/usr/lib/systemd/system/pmanager_update.timer

  install -Dm644 LICENSE ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE
}
