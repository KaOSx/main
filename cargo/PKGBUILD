
pkgname=cargo
_pkgname=cargo-nightly-x86_64-unknown-linux-gnu
pkgver=0.20.0
pkgrel=1
arch=('x86_64')
pkgdesc='Downloads your Rust projectâ€™s dependencies and compiles your project'
url='https://crates.io/install'
license=('MIT' 'Apache')
depends=('rust' 'curl')
makedepends=('cmake' 'python3' 'cargo')
source=("https://github.com/rust-lang/cargo/archive/0.20.0.tar.gz")
#source=("https://s3.amazonaws.com/rust-lang-ci/cargo-builds/6b05583d71f982bcad049b9fa094c637c062e751/${_pkgname}.tar.gz")
md5sums=('db010d429ee6dd5de604f7516ffbcbe1')

build() {
  cd ${pkgname}-${pkgver}
  
  cargo build --release

}

package() {
  cd ${pkgname}-${pkgver}
  cargo install --root ${pkgdir}/usr
  
  install -D -m644 src/etc/cargo.bashcomp.sh ${pkgdir}/etc/bash_completion.d/cargo
  install -D -m644 src/etc/_cargo ${pkgdir}/usr/share/zsh/site-functions/_cargo
  
  mkdir -p ${pkgdir}/usr/share/man/man1/
  install -D -m644 src/etc/man/* ${pkgdir}/usr/share/man/man1/
  
  rm ${pkgdir}/usr/.crates.toml

  install -Dm644 LICENSE-APACHE ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE-APACHE
  install -Dm644 LICENSE-MIT ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE-MIT
  install -Dm644 LICENSE-THIRD-PARTY ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE-THIRD-PARTY
} 
